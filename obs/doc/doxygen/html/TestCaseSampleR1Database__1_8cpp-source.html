<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OBS Framework: TestCaseSampleR1Database_1.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>TestCaseSampleR1Database_1.cpp</h1><pre class="fragment"><div>00001   
00002 <span class="comment">//</span>
00003 <span class="comment">// Copyright 2003 P&amp;P Software GmbH - All Rights Reserved</span>
00004 <span class="comment">//</span>
00005 <span class="comment">// TestCaseSampleR1Database_1.cpp</span>
00006 <span class="comment">//</span>
00007 <span class="comment">// This file was automatically generated by an XSL program</span>
00008 <span class="comment">//</span>
00009 
00010 <span class="preprocessor">#include "../GeneralInclude/CompilerSwitches.h"</span>
00011 <span class="preprocessor">#include "../GeneralInclude/ClassId.h"</span>
00012 <span class="preprocessor">#include "../GeneralInclude/Constants.h"</span>
00013 <span class="preprocessor">#include "../Data/DC_SampleR1Database.h"</span>
00014 <span class="preprocessor">#include "TestCaseSampleR1Database_1.h"</span>
00015 <span class="preprocessor">#include "../Utilities/TestCaseWithEvtCheck.h"</span>
00016 
00017 <span class="preprocessor">#include &lt;math.h&gt;</span>
00018 <span class="preprocessor">#include &lt;float.h&gt;</span>
00019 
<a name="l00020"></a><a class="code" href="classTestCaseSampleR1Database__1.html#a0">00020</a> <a class="code" href="classTestCaseSampleR1Database__1.html#a0">TestCaseSampleR1Database_1::TestCaseSampleR1Database_1</a>():
00021         <a class="code" href="classTestCaseWithEvtCheck.html">TestCaseWithEvtCheck</a>(ID_SAMPLER1DATABASE*10+1,"<a class="code" href="classTestCaseSampleR1Database__1.html">TestCaseSampleR1Database_1</a>") {
00022                 <span class="keywordflow">return</span>;
00023 }
00024 
<a name="l00025"></a><a class="code" href="classTestCaseSampleR1Database__1.html#a1">00025</a> <span class="keywordtype">void</span> <a class="code" href="classTestCaseSampleR1Database__1.html#a1">TestCaseSampleR1Database_1::runTestCase</a>() {
00026 
00027    <span class="comment">// Data structures to simulate the default and operational tables</span>
00028    <span class="comment">// (The size of the database is read from the Parameter Database</span>
00029    <span class="comment">// Descriptor file).</span>
00030    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dbLength = 50;
00031    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* defaultTable = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[dbLength];
00032    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* operationalTable = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[dbLength];
00033 
00034    <span class="comment">// Initialize the default database. Each parameter is given a</span>
00035    <span class="comment">// value equal to its parameter ID. The parameter ID is read from</span>
00036    <span class="comment">// the Parameter Database Descriptor File. Note that this</span>
00037    <span class="comment">// strategy will sometimes result in an attempt to assign to a</span>
00038    <span class="comment">// parameter a value that is inconsistent with its type (e.g. a</span>
00039    <span class="comment">// a parameter of type 'char' might have a parameter ID greater than</span>
00040    <span class="comment">// 256).</span>
00041    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* uc;
00042    
00043    uc = (defaultTable+0);
00044    *(<span class="keywordtype">float</span>*)uc = (<span class="keywordtype">float</span>)1;
00045    uc = (defaultTable+8);
00046    *(<span class="keywordtype">float</span>*)uc = (<span class="keywordtype">float</span>)2;
00047    uc = (defaultTable+16);
00048    *(<span class="keywordtype">float</span>*)uc = (<span class="keywordtype">float</span>)3;
00049    uc = (defaultTable+24);
00050    *(<span class="keywordtype">float</span>*)uc = (<span class="keywordtype">float</span>)4;
00051 
00052    <span class="comment">// Get current number of events in event repository</span>
00053    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nEvt;
00054    nEvt = <a class="code" href="classTestCaseWithEvtCheck.html#b0">getNumberOfEvents</a>();
00055 
00056    <span class="comment">// Initialize the operational database to all zeros</span>
00057    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;dbLength; i++)
00058        operationalTable[i]=0;
00059 
00060    <span class="comment">// Instantiate parameter database</span>
00061    <a class="code" href="classDC__SampleR1Database.html">DC_SampleR1Database</a>* pDB = <span class="keyword">new</span> <a class="code" href="classDC__SampleR1Database.html">DC_SampleR1Database</a>();
00062 
00063    <span class="comment">// Variable to hold the maximum parId</span>
00064    <a class="code" href="BasicTypes_8h.html#a15">TD_DatabaseId</a> maxParId;
00065    maxParId = 4;
00066 
00067    <span class="comment">// Variable to hold the lowest illegal parId</span>
00068    <a class="code" href="BasicTypes_8h.html#a15">TD_DatabaseId</a> illegalParId;
00069    illegalParId = 5;
00070 
00071    <span class="comment">// Verify correctness of class ID</span>
00072    <span class="keywordflow">if</span> (pDB-&gt;<a class="code" href="classCC__RootObject.html#a3">getClassId</a>() != ID_SAMPLER1DATABASE)
00073    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Wrong class ID"</span>);
00074             <span class="keywordflow">return</span>;
00075     }
00076 
00077    <span class="comment">// Check that database is not yet configured</span>
00078    <span class="keywordflow">if</span> ( pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a31">isObjectConfigured</a>() != <a class="code" href="Constants_8h.html#a1">NOT_CONFIGURED</a> )
00079    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect configuration status at creation"</span>);
00080             <span class="keywordflow">return</span>;
00081     }
00082 
00083    <span class="comment">// Configure database</span>
00084    pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a2">setDefaultTable</a>((<span class="keywordtype">char</span>*)defaultTable);
00085    pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a3">setOperationalTable</a>((<span class="keywordtype">char</span>*)operationalTable);
00086    pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a1">reset</a>();
00087 
00088    <span class="comment">// Check that database is configured</span>
00089    <span class="keywordflow">if</span> ( pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a31">isObjectConfigured</a>() != <a class="code" href="Constants_8h.html#a0">CONFIGURED</a> )
00090    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect configuration status after configuration was completed"</span>);
00091             <span class="keywordflow">return</span>;
00092    }
00093 
00094    <span class="comment">// Check the pointer getter methods</span>
00095    
00096    <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a29">getParameterPointerFloat</a>(1)!=operationalTable+0)
00097    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect pointer value for parameter"</span>);
00098             <span class="keywordflow">return</span>;
00099    }
00100    <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a29">getParameterPointerFloat</a>(2)!=operationalTable+8)
00101    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect pointer value for parameter"</span>);
00102             <span class="keywordflow">return</span>;
00103    }
00104    <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a29">getParameterPointerFloat</a>(3)!=operationalTable+16)
00105    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect pointer value for parameter"</span>);
00106             <span class="keywordflow">return</span>;
00107    }
00108    <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a29">getParameterPointerFloat</a>(4)!=operationalTable+24)
00109    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect pointer value for parameter"</span>);
00110             <span class="keywordflow">return</span>;
00111    }
00112 
00113    <span class="comment">// Check that non-real paramaters have the correct value</span>
00114    
00115 
00116    <span class="comment">// Check that real parameters have the correct value</span>
00117    
00118    <span class="keywordflow">if</span> (fabs(pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a20">getParameterFloat</a>(1)-1) &gt; DBL_EPSILON)
00119    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect value for parameter"</span>);
00120             <span class="keywordflow">return</span>;
00121    }
00122    <span class="keywordflow">if</span> (fabs(pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a20">getParameterFloat</a>(2)-2) &gt; DBL_EPSILON)
00123    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect value for parameter"</span>);
00124             <span class="keywordflow">return</span>;
00125    }
00126    <span class="keywordflow">if</span> (fabs(pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a20">getParameterFloat</a>(3)-3) &gt; DBL_EPSILON)
00127    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect value for parameter"</span>);
00128             <span class="keywordflow">return</span>;
00129    }
00130    <span class="keywordflow">if</span> (fabs(pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a20">getParameterFloat</a>(4)-4) &gt; DBL_EPSILON)
00131    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect value for parameter"</span>);
00132             <span class="keywordflow">return</span>;
00133    }
00134 
00135    <span class="comment">// Update the value of all parameters by setting it equal to their (parId+1)</span>
00136    
00137    pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a4">setParameter</a>(1,(<span class="keywordtype">float</span>)(1+1)); 
00138    pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a4">setParameter</a>(2,(<span class="keywordtype">float</span>)(2+1)); 
00139    pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a4">setParameter</a>(3,(<span class="keywordtype">float</span>)(3+1)); 
00140    pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a4">setParameter</a>(4,(<span class="keywordtype">float</span>)(4+1)); 
00141 
00142    <span class="comment">// Check that non-real paramaters have the correct value</span>
00143    
00144 
00145    <span class="comment">// Check that real paramaters have the correct value</span>
00146    
00147    <span class="keywordflow">if</span> (fabs(pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a20">getParameterFloat</a>(1)-(1+1)) &gt; DBL_EPSILON)
00148    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect value for parameter 1"</span>);
00149             <span class="keywordflow">return</span>;
00150    } 
00151    <span class="keywordflow">if</span> (fabs(pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a20">getParameterFloat</a>(2)-(2+1)) &gt; DBL_EPSILON)
00152    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect value for parameter 2"</span>);
00153             <span class="keywordflow">return</span>;
00154    } 
00155    <span class="keywordflow">if</span> (fabs(pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a20">getParameterFloat</a>(3)-(3+1)) &gt; DBL_EPSILON)
00156    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect value for parameter 3"</span>);
00157             <span class="keywordflow">return</span>;
00158    } 
00159    <span class="keywordflow">if</span> (fabs(pDB-&gt;<a class="code" href="classDC__SampleR1Database.html#a20">getParameterFloat</a>(4)-(4+1)) &gt; DBL_EPSILON)
00160    {      setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>, <span class="stringliteral">"Incorrect value for parameter 4"</span>);
00161             <span class="keywordflow">return</span>;
00162    } 
00163         setTestResult(<a class="code" href="TestConstants_8h.html#a0">TEST_SUCCESS</a>,<span class="stringliteral">"Test Successful"</span>);
00164         <span class="keywordflow">return</span>;
00165 }
</div></pre><center>
<b>Copyright 2003 <a href="http://www.pnp-software.com/" target="_parent">P&P Software GmbH</a> - All Rights Reserved</b>
</center>
