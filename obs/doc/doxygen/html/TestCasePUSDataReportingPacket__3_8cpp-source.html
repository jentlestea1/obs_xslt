<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OBS Framework: TestCasePUSDataReportingPacket_3.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>TestCasePUSDataReportingPacket_3.cpp</h1><pre class="fragment"><div>00001 <span class="comment">//</span>
00002 <span class="comment">// Copyright 2004 P&amp;P Software GmbH - All Rights Reserved</span>
00003 <span class="comment">//</span>
00004 <span class="comment">// TestCasePUSDataReportingPacket_3.cpp</span>
00005 <span class="comment">//</span>
00006 <span class="comment">// Version      1.0</span>
00007 <span class="comment">// Date         04.12.03</span>
00008 <span class="comment">// Author       A. Pasetti (P&amp;P Software)</span>
00009 
00010 <span class="preprocessor">#include "../GeneralInclude/CompilerSwitches.h"</span>
00011 <span class="preprocessor">#include "../GeneralInclude/ClassId.h"</span>
00012 <span class="preprocessor">#include "../GeneralInclude/BasicTypes.h"</span>
00013 <span class="preprocessor">#include "../GeneralInclude/Constants.h"</span>
00014 <span class="preprocessor">#include "../Telemetry/DC_PUSDataReportingPacket.h"</span>
00015 <span class="preprocessor">#include "../Data/DC_SampleFullDataPool.h"</span>
00016 <span class="preprocessor">#include "../Utilities/TestCaseWithEvtCheck.h"</span>
00017 <span class="preprocessor">#include "TestCasePUSDataReportingPacket_3.h"</span>
00018 
00019 <span class="preprocessor">#include &lt;math.h&gt;</span>
00020 <span class="preprocessor">#include &lt;float.h&gt;</span>
00021 <span class="preprocessor">#include &lt;assert.h&gt;</span>
00022 <span class="preprocessor">#include &lt;string.h&gt;</span>
00023 
<a name="l00024"></a><a class="code" href="classTestCasePUSDataReportingPacket__3.html#a0">00024</a> <a class="code" href="classTestCasePUSDataReportingPacket__3.html#a0">TestCasePUSDataReportingPacket_3::TestCasePUSDataReportingPacket_3</a>(<span class="keywordtype">void</span>) :
00025         <a class="code" href="classTestCaseWithEvtCheck.html">TestCaseWithEvtCheck</a>(ID_PUSDATAREPORTINGPACKET*10+3,"<a class="code" href="classTestCasePUSDataReportingPacket__3.html">TestCasePUSDataReportingPacket_3</a>") {
00026                 <span class="keywordflow">return</span>;
00027 }
00028 
<a name="l00029"></a><a class="code" href="classTestCasePUSDataReportingPacket__3.html#a1">00029</a> <span class="keywordtype">void</span> <a class="code" href="classTestCasePUSDataReportingPacket__3.html#a1">TestCasePUSDataReportingPacket_3::runTestCase</a>(<span class="keywordtype">void</span>) {
00030 
00031    <a class="code" href="classDC__SampleFullDataPool.html">DC_SampleFullDataPool</a>* pDP = <span class="keyword">new</span> <a class="code" href="classDC__SampleFullDataPool.html">DC_SampleFullDataPool</a>();
00032    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nEvt = <a class="code" href="classTestCaseWithEvtCheck.html#b0">getNumberOfEvents</a>();
00033    <a class="code" href="classDC__PUSDataReportingPacket.html">DC_PUSDataReportingPacket</a>* pTMP = <span class="keyword">new</span> <a class="code" href="classDC__PUSDataReportingPacket.html">DC_PUSDataReportingPacket</a>();
00034 
00035    <span class="comment">// Configure and load the data pool</span>
00036    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a1">setObsClock</a>(DC_PUSDataReportingPacket::getObsClock());
00037    <a class="code" href="classDataPool.html">DataPool</a>* pOldDP = <a class="code" href="classCC__RootObject.html#e8">CC_RootObject::getDataPool</a>();
00038    CC_RootObject::setDataPool(pDP);
00039 
00040    <span class="comment">// Define the PUS packet</span>
00041    <a class="code" href="BasicTypes_8h.html#a21">TD_SID</a> sid = 12;
00042    <a class="code" href="BasicTypes_8h.html#a23">TD_PUSCollectionInterval</a> collectionInterval = 6;
00043    <a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a> NPAR1 = 1;
00044    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> NFA = 2;
00045    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> NREP2 = 2;
00046    <a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a> NPAR2 = 2;
00047    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> NREP3 = 3;
00048    <a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a> NPAR3 = 1;
00049    <a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a> par1 = 1;
00050    <a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a> val1 = 11;
00051    <a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a> par2 = 2;
00052    <a class="code" href="BasicTypes_8h.html#a17">TD_Float</a> val2 = 12.0;
00053    <a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a> par3 = 4;
00054    <a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a> val3 = 14;
00055    <a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a> par4 = 5;
00056    <a class="code" href="BasicTypes_8h.html#a17">TD_Float</a> val4 = 15.0;
00057 
00058    <span class="comment">// Construct the packet</span>
00059    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> defPacketSize = 300;
00060    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* packet = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[defPacketSize];
00061    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> offset = 0;
00062 
00063    memcpy(packet+offset,&amp;sid,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>));
00064    offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>);
00065    memcpy(packet+offset,&amp;collectionInterval,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a23">TD_PUSCollectionInterval</a>));
00066    offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a23">TD_PUSCollectionInterval</a>);
00067    memcpy(packet+offset,&amp;NPAR1,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a>));
00068    offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a>);
00069    memcpy(packet+offset,&amp;par1,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a>));
00070    offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a>);
00071    memcpy(packet+offset,&amp;NFA,1);
00072    offset += 1;
00073    memcpy(packet+offset,&amp;NREP2,1);
00074    offset += 1;
00075    memcpy(packet+offset,&amp;NPAR2,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a>));
00076    offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a>);
00077    memcpy(packet+offset,&amp;par2,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a>));
00078    offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a>);
00079    memcpy(packet+offset,&amp;par3,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a>));
00080    offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a>);
00081    memcpy(packet+offset,&amp;NREP3,1);
00082    offset += 1;
00083    memcpy(packet+offset,&amp;NPAR3,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a>));
00084    offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a>);
00085    memcpy(packet+offset,&amp;par4,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a>));
00086    offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a>);
00087 
00088    assert(offset&lt;defPacketSize);
00089 
00090    <span class="comment">// Configure the data reporting packet and check configuration status</span>
00091    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a18">setMaxNumberFA</a>(2);
00092    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a16">setDefinitionBufferSize</a>(defPacketSize);
00093    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> valBufferSize = 75;
00094    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a20">setValueBufferSize</a>(valBufferSize);
00095    pTMP-&gt;<a class="code" href="classPUSTelemetryPacket.html#a2">setSubType</a>(<a class="code" href="Constants_8h.html#a70">PUS_ST_DATA_REP_PAR_HK_REP</a>);
00096    pTMP-&gt;<a class="code" href="classPUSTelemetryPacket.html#a7">setTimeTag</a>(0);
00097    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a1">setEnabled</a>(<a class="code" href="Constants_8h.html#a3">ENABLED</a>);
00098    <span class="keywordflow">if</span> ( !pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a22">isObjectConfigured</a>() )
00099    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong configuration status"</span>);
00100         <span class="keywordflow">return</span>;
00101    }
00102 
00103    <span class="comment">// Load the packet definition</span>
00104    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;offset; i++)
00105         pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a7">setDefinitionBuffer</a>(i,packet[i]);
00106 
00107    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a9">getDefinitionBufferLength</a>()!=offset)
00108    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong definition buffer length"</span>);
00109         <span class="keywordflow">return</span>;
00110    }
00111 
00112    <span class="comment">// Set the values of the data pool items</span>
00113    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,val1);
00114    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,val2);
00115    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,val3);
00116    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,val4);
00117 
00118    <span class="comment">// Send five update requests and check that there are no data to be acquired</span>
00119    <span class="comment">// The data pool item values are updated after each update request</span>
00120    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00121    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=0)
00122    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00123         <span class="keywordflow">return</span>;
00124    }
00125    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(2*val1));
00126    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(2*val2));
00127    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(2*val3));
00128    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(2*val4));
00129 
00130    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00131    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=0)
00132    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00133         <span class="keywordflow">return</span>;
00134    }
00135    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(3*val1));
00136    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(3*val2));
00137    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(3*val3));
00138    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(3*val4));
00139 
00140    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00141    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=0)
00142    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00143         <span class="keywordflow">return</span>;
00144    }
00145    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(4*val1));
00146    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(4*val2));
00147    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(4*val3));
00148    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(4*val4));
00149 
00150    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00151    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=0)
00152    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00153         <span class="keywordflow">return</span>;
00154    }
00155    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(5*val1));
00156    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(5*val2));
00157    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(5*val3));
00158    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(5*val4));
00159 
00160    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00161    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=0)
00162    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00163         <span class="keywordflow">return</span>;
00164    }
00165    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(6*val1));
00166    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(6*val2));
00167    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(6*val3));
00168    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(6*val4));
00169 
00170    <span class="comment">// Send the sixth update request and check data acquisition service</span>
00171    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00172    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(7*val1));
00173    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(7*val2));
00174    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(7*val3));
00175    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(7*val4));
00176 
00177    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n1, n2, n3;
00178    n1 = <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>);
00179    n2 = (<a class="code" href="Constants_8h.html#a34">PUS_DATA_REP_MODE</a>?1:0);
00180    n3 = 1*<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)+2*<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)+2*<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)+3*<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>);
00181    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> expNumberOfBytes = n1+n2+n3;
00182    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=expNumberOfBytes)
00183    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00184         <span class="keywordflow">return</span>;
00185    }
00186 
00187    <span class="comment">// Collect the packet data and check their values</span>
00188    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* valBuffer = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[valBufferSize];
00189    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>(); i++) {
00190        valBuffer[i] = pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a13">getUnsignedByte</a>(i);
00191        assert(i&lt;valBufferSize);
00192    }
00193 
00194    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> valOffset = 0;
00195    <a class="code" href="BasicTypes_8h.html#a21">TD_SID</a> sidTemp = 0;
00196    <a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a> intTemp = 0;
00197    <a class="code" href="BasicTypes_8h.html#a17">TD_Float</a> flTemp = 0;
00198 
00199    memcpy(&amp;sidTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>));
00200    <span class="keywordflow">if</span> ( sidTemp != sid )
00201    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong sid field"</span>);
00202         <span class="keywordflow">return</span>;
00203    }
00204    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>);
00205 
00206    <span class="keywordflow">if</span> ( <a class="code" href="Constants_8h.html#a34">PUS_DATA_REP_MODE</a>?valBuffer[valOffset]!=0:<span class="keyword">false</span> )
00207    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong mode field"</span>);
00208         <span class="keywordflow">return</span>;
00209    }
00210    valOffset += (<a class="code" href="Constants_8h.html#a34">PUS_DATA_REP_MODE</a>?1:0);
00211 
00212    memcpy(&amp;intTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>));
00213    <span class="keywordflow">if</span> ( intTemp != (<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)6*val1 )
00214    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 1 field"</span>);
00215         <span class="keywordflow">return</span>;
00216    }
00217    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>);
00218 
00219    memcpy(&amp;flTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>));
00220    <span class="keywordflow">if</span> ( fabs((<span class="keywordtype">float</span>)(flTemp - (<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)3*val2)) &gt; FLT_EPSILON )
00221    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 2 field"</span>);
00222         <span class="keywordflow">return</span>;
00223    }
00224    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>);
00225 
00226    memcpy(&amp;intTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>));
00227    <span class="keywordflow">if</span> ( intTemp != (<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)3*val3 )
00228    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 3 field"</span>);
00229         <span class="keywordflow">return</span>;
00230    }
00231    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>);
00232 
00233    memcpy(&amp;flTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>));
00234    <span class="keywordflow">if</span> ( fabs((<span class="keywordtype">float</span>)(flTemp - (<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)6*val2)) &gt; FLT_EPSILON )
00235    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 2 field"</span>);
00236         <span class="keywordflow">return</span>;
00237    }
00238    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>);
00239 
00240    memcpy(&amp;intTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>));
00241    <span class="keywordflow">if</span> ( intTemp  != (<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)6*val3 )
00242    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 3 field"</span>);
00243         <span class="keywordflow">return</span>;
00244    }
00245    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>);
00246 
00247    memcpy(&amp;flTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>));
00248    <span class="keywordflow">if</span> ( fabs((<span class="keywordtype">float</span>)(flTemp  - (<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)2*val4)) &gt; FLT_EPSILON )
00249    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 4 field"</span>);
00250         <span class="keywordflow">return</span>;
00251    }
00252    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>);
00253 
00254    memcpy(&amp;flTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>));
00255    <span class="keywordflow">if</span> ( fabs((<span class="keywordtype">float</span>)(flTemp  - (<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)4*val4)) &gt; FLT_EPSILON )
00256    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 4 field"</span>);
00257         <span class="keywordflow">return</span>;
00258    }
00259    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>);
00260 
00261    memcpy(&amp;flTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>));
00262    <span class="keywordflow">if</span> ( fabs((<span class="keywordtype">float</span>)(flTemp  - (<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)6*val4)) &gt; FLT_EPSILON )
00263    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 4 field"</span>);
00264         <span class="keywordflow">return</span>;
00265    }
00266 
00267    assert(valOffset&lt;valBufferSize);
00268 
00269    <span class="comment">// Send five update requests and check that there are no data to be acquired</span>
00270    <span class="comment">// The data pool item values are updated after each update request</span>
00271    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00272    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=0)
00273    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00274         <span class="keywordflow">return</span>;
00275    }
00276    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(8*val1));
00277    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(8*val2));
00278    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(8*val3));
00279    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(8*val4));
00280 
00281    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00282    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=0)
00283    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00284         <span class="keywordflow">return</span>;
00285    }
00286    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(9*val1));
00287    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(9*val2));
00288    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(9*val3));
00289    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(9*val4));
00290 
00291    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00292    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=0)
00293    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00294         <span class="keywordflow">return</span>;
00295    }
00296    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(10*val1));
00297    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(10*val2));
00298    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(10*val3));
00299    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(10*val4));
00300 
00301    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00302    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=0)
00303    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00304         <span class="keywordflow">return</span>;
00305    }
00306    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(11*val1));
00307    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(11*val2));
00308    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(11*val3));
00309    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(11*val4));
00310 
00311    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00312    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=0)
00313    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00314         <span class="keywordflow">return</span>;
00315    }
00316    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par1,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(12*val1));
00317    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par2,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(12*val2));
00318    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par3,(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(12*val3));
00319    pDP-&gt;<a class="code" href="classDC__SampleFullDataPool.html#a3">setValue</a>(par4,(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(12*val4));
00320 
00321    <span class="comment">// Send the sixth update request and check data acquisition service</span>
00322    pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00323 
00324    n1, n2, n3;
00325    n1 = <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>);
00326    n2 = (<a class="code" href="Constants_8h.html#a34">PUS_DATA_REP_MODE</a>?1:0);
00327    n3 = 1*<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)+2*<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)+2*<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)+3*<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>);
00328    expNumberOfBytes = n1+n2+n3;
00329    <span class="keywordflow">if</span> (pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>()!=expNumberOfBytes)
00330    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong number of bytes"</span>);
00331         <span class="keywordflow">return</span>;
00332    }
00333 
00334    <span class="comment">// Collect the packet data and check their values</span>
00335    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a12">getNumberOfBytes</a>(); i++) {
00336        valBuffer[i] = pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a13">getUnsignedByte</a>(i);
00337        assert(i&lt;valBufferSize);
00338    }
00339 
00340    valOffset = 0;
00341    memcpy(&amp;sidTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>));
00342    <span class="keywordflow">if</span> ( memcmp(valBuffer+valOffset,&amp;sid,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>))!=0 )
00343    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong sid field"</span>);
00344         <span class="keywordflow">return</span>;
00345    }
00346    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>);
00347 
00348    <span class="keywordflow">if</span> ( <a class="code" href="Constants_8h.html#a34">PUS_DATA_REP_MODE</a>?valBuffer[valOffset]!=0:<span class="keyword">false</span> )
00349    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong mode field"</span>);
00350         <span class="keywordflow">return</span>;
00351    }
00352    valOffset += (<a class="code" href="Constants_8h.html#a34">PUS_DATA_REP_MODE</a>?1:0);
00353 
00354    memcpy(&amp;intTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>));
00355    <span class="keywordflow">if</span> ( intTemp != (<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)12*val1 )
00356    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 1 field"</span>);
00357         <span class="keywordflow">return</span>;
00358    }
00359    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>);
00360 
00361    memcpy(&amp;flTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>));
00362    <span class="keywordflow">if</span> ( fabs((<span class="keywordtype">float</span>)(flTemp  - (<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)9*val2)) &gt; FLT_EPSILON )
00363    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 2 field"</span>);
00364         <span class="keywordflow">return</span>;
00365    }
00366    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>);
00367 
00368    memcpy(&amp;intTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>));
00369    <span class="keywordflow">if</span> ( intTemp != (<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)9*val3 )
00370    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 3 field"</span>);
00371         <span class="keywordflow">return</span>;
00372    }
00373    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>);
00374 
00375    memcpy(&amp;flTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>));
00376    <span class="keywordflow">if</span> ( fabs((<span class="keywordtype">float</span>)(flTemp  - (<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)12*val2)) &gt; FLT_EPSILON )
00377    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 2 field"</span>);
00378         <span class="keywordflow">return</span>;
00379    }
00380    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>);
00381 
00382    memcpy(&amp;intTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>));
00383    <span class="keywordflow">if</span> ( intTemp != (<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)12*val3 )
00384    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 3 field"</span>);
00385         <span class="keywordflow">return</span>;
00386    }
00387    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>);
00388 
00389    memcpy(&amp;flTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>));
00390    <span class="keywordflow">if</span> ( fabs((<span class="keywordtype">float</span>)(flTemp  - (<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)8*val4)) &gt; FLT_EPSILON )
00391    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 4 field"</span>);
00392         <span class="keywordflow">return</span>;
00393    }
00394    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>);
00395 
00396    memcpy(&amp;flTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>));
00397    <span class="keywordflow">if</span> ( fabs((<span class="keywordtype">float</span>)(flTemp  - (<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)10*val4)) &gt; FLT_EPSILON )
00398    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 4 field"</span>);
00399         <span class="keywordflow">return</span>;
00400    }
00401    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>);
00402 
00403    memcpy(&amp;flTemp,valBuffer+valOffset,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>));
00404    <span class="keywordflow">if</span> ( fabs((<span class="keywordtype">float</span>)(flTemp  - (<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)12*val4)) &gt; FLT_EPSILON )
00405    {    setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong parameter 4 field"</span>);
00406         <span class="keywordflow">return</span>;
00407    }
00408    valOffset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>);
00409    assert(valOffset&lt;valBufferSize);
00410 
00411    <span class="comment">// Construct a packet that will cause the packet value buffer to overflow</span>
00412    <span class="keywordflow">if</span> (<a class="code" href="classTestCase.html#b1">isNonNominalCheckAllowed</a>()) {
00413        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nIntPar = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(valBufferSize - <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>) -
00414                                                 (<a class="code" href="Constants_8h.html#a34">PUS_DATA_REP_MODE</a>?1:0))/<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)+1;
00415        sid = 13;
00416        collectionInterval = 1;
00417        NPAR1 = (<a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a>)nIntPar;
00418        NFA = 0;
00419        par1 = 1;
00420 
00421        offset = 0;                                  <span class="comment">// the new packet is defined</span>
00422        memcpy(packet+offset,&amp;sid,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>));
00423        offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a21">TD_SID</a>);
00424        memcpy(packet+offset,&amp;collectionInterval,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a23">TD_PUSCollectionInterval</a>));
00425        offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a23">TD_PUSCollectionInterval</a>);
00426        memcpy(packet+offset,&amp;NPAR1,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a>));
00427        offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a24">TD_PUSNumberOfParameters</a>);
00428 
00429        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;NPAR1; i++) {
00430             memcpy(packet+offset,&amp;par1,<span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a>));
00431             offset += <span class="keyword">sizeof</span>(<a class="code" href="BasicTypes_8h.html#a16">TD_DataPoolId</a>);
00432        }
00433        assert(offset&lt;defPacketSize);
00434 
00435        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;offset; i++)      <span class="comment">// the new packet definition is loaded</span>
00436             pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a7">setDefinitionBuffer</a>(i,packet[i]);
00437 
00438        pTMP-&gt;<a class="code" href="classDC__PUSDataReportingPacket.html#a10">update</a>();
00439 
00440        <span class="keywordflow">if</span> ( !verifyLatestEvent(nEvt+1,EVT_PUS_DATA_REP_PACKET_TOO_LARGE) )
00441             <span class="keywordflow">return</span>;
00442        nEvt = nEvt+1;
00443    }
00444 
00445    <span class="comment">// Restore the original data pool</span>
00446    CC_RootObject::setDataPool(pOldDP);
00447 
00448    setTestResult(<a class="code" href="TestConstants_8h.html#a0">TEST_SUCCESS</a>,<span class="stringliteral">"Test Successful"</span>);
00449    <span class="keywordflow">return</span>;
00450 }
</div></pre><center>
<b>Copyright 2003 <a href="http://www.pnp-software.com/" target="_parent">P&P Software GmbH</a> - All Rights Reserved</b>
</center>
