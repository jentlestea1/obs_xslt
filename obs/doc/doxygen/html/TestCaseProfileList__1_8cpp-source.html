<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OBS Framework: TestCaseProfileList_1.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>TestCaseProfileList_1.cpp</h1><pre class="fragment"><div>00001 <span class="comment">//</span>
00002 <span class="comment">// Copyright 2004 P&amp;P Software GmbH - All Rights Reserved</span>
00003 <span class="comment">//</span>
00004 <span class="comment">// TestCaseProfileList_1.cpp</span>
00005 <span class="comment">//</span>
00006 <span class="comment">// Version      1.3</span>
00007 <span class="comment">// Date         15.09.03 (Version 1.0)</span>
00008 <span class="comment">//          01.10.03 (Version 1.1)</span>
00009 <span class="comment">//          08.10.03 (Version 1.2)</span>
00010 <span class="comment">//          21.10.03 (Version 1.3)</span>
00011 <span class="comment">// Author       R. Totaro</span>
00012 <span class="comment">//</span>
00013 <span class="comment">// Change Record:</span>
00014 <span class="comment">//   Version 1.1: Replaced double and int with TD_Float and TD_Integer</span>
00015 <span class="comment">//   Version 1.2: Added check that isObjectConfigured() works according to specs</span>
00016 <span class="comment">//   Version 1.3: Replaced all occurrences of loadMonitoringProfile() with setMonitoringProfile()</span>
00017 
00018 <span class="preprocessor">#include "../GeneralInclude/CompilerSwitches.h"</span>
00019 <span class="preprocessor">#include "../GeneralInclude/ClassId.h"</span>
00020 <span class="preprocessor">#include "../GeneralInclude/Constants.h"</span>
00021 <span class="preprocessor">#include "../FDIR/DC_InRangeProfile.h"</span>
00022 <span class="preprocessor">#include "../FDIR/DC_ProfileList.h"</span>
00023 <span class="preprocessor">#include "TestCaseProfileList_1.h"</span>
00024 
<a name="l00025"></a><a class="code" href="classTestCaseProfileList__1.html#a0">00025</a> <a class="code" href="classTestCaseProfileList__1.html#a0">TestCaseProfileList_1::TestCaseProfileList_1</a>(<span class="keywordtype">void</span>) :
00026         <a class="code" href="classTestCaseWithEvtCheck.html">TestCaseWithEvtCheck</a>(ID_PROFILELIST*10+1,"<a class="code" href="classTestCaseProfileList__1.html">TestCaseProfileList_1</a>") {
00027         <span class="keywordflow">return</span>;
00028 }
00029 
<a name="l00030"></a><a class="code" href="classTestCaseProfileList__1.html#a1">00030</a> <span class="keywordtype">void</span> <a class="code" href="classTestCaseProfileList__1.html#a1">TestCaseProfileList_1::runTestCase</a>(<span class="keywordtype">void</span>) {
00031         <a class="code" href="classDC__ProfileList.html">DC_ProfileList</a>    *pPL       =<span class="keyword">new</span> <a class="code" href="classDC__ProfileList.html">DC_ProfileList</a>;
00032     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nEvt      =<a class="code" href="classTestCaseWithEvtCheck.html#b0">getNumberOfEvents</a>();
00033         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> listSize  =2;
00034         <span class="keyword">const</span> <a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>     rangeWidth=5.0;
00035         <a class="code" href="classDC__InRangeProfile.html">DC_InRangeProfile</a> *pIRP[listSize];
00036 
00037         <span class="comment">// Create and initialize the monitoring profiles we are using to</span>
00038         <span class="comment">// test the DC_ProfileList class.</span>
00039         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;listSize;i++) {
00040                 pIRP[i]=<span class="keyword">new</span> <a class="code" href="classDC__InRangeProfile.html">DC_InRangeProfile</a>;
00041                 pIRP[i]-&gt;<a class="code" href="classRangeProfile.html#a1">setLowerBound</a>((<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)i);
00042                 pIRP[i]-&gt;<a class="code" href="classRangeProfile.html#a2">setUpperBound</a>((<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)i+rangeWidth);
00043         }
00044 
00045         <span class="comment">// Verify the correctness of the class id</span>
00046         <span class="keywordflow">if</span> (pPL-&gt;<a class="code" href="classCC__RootObject.html#a3">getClassId</a>()!=ID_PROFILELIST) {
00047                 setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong class identifier"</span>);
00048                 <span class="keywordflow">return</span>;
00049         }
00050 
00051         <span class="comment">// A new object shall not be configured</span>
00052         <span class="keywordflow">if</span> (pPL-&gt;<a class="code" href="classDC__ProfileList.html#a5">isObjectConfigured</a>()) {
00053                 setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Newly created object already configured"</span>);
00054                 <span class="keywordflow">return</span>;
00055         }
00056 
00057         <span class="comment">// Set the list size and verify it is reported correctly</span>
00058         pPL-&gt;<a class="code" href="classDC__ProfileList.html#a1">setListSize</a>(listSize);
00059         <span class="keywordflow">if</span> (pPL-&gt;<a class="code" href="classDC__ProfileList.html#a2">getListSize</a>()!=listSize) {
00060                 setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"getListSize() failed"</span>);
00061                 <span class="keywordflow">return</span>;
00062         }
00063 
00064         <span class="comment">// Load and get the monitoring profiles</span>
00065         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;listSize;i++) {
00066             <span class="comment">// The object is fully configured only when all the profiles are loaded!</span>
00067             <span class="keywordflow">if</span> (pPL-&gt;<a class="code" href="classDC__ProfileList.html#a5">isObjectConfigured</a>()) {
00068                     setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Wrong configuration status"</span>);
00069                     <span class="keywordflow">return</span>;
00070             }
00071 
00072                 pPL-&gt;<a class="code" href="classDC__ProfileList.html#a3">setMonitoringProfile</a>(i,pIRP[i]);
00073 
00074                 <span class="keywordflow">if</span> (pPL-&gt;<a class="code" href="classDC__ProfileList.html#a4">getMonitoringProfile</a>(i)!=pIRP[i]) {
00075                         setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"setMonitoringProfile() failed"</span>);
00076                         <span class="keywordflow">return</span>;
00077                 }
00078         }
00079 
00080         <span class="comment">// Only now it is configured. Let's check it.</span>
00081         <span class="keywordflow">if</span> (!pPL-&gt;<a class="code" href="classDC__ProfileList.html#a5">isObjectConfigured</a>()) {
00082                 setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"Object not configured"</span>);
00083                 <span class="keywordflow">return</span>;
00084         }
00085 
00086     <span class="comment">// Verify that setMonitoringProfile() generates an error report</span>
00087         <span class="comment">// when invoked with an invalid index</span>
00088     <span class="keywordflow">if</span> (<a class="code" href="classTestCase.html#b1">isNonNominalCheckAllowed</a>()) {
00089             pPL-&gt;<a class="code" href="classDC__ProfileList.html#a3">setMonitoringProfile</a>(listSize,pIRP[0]);
00090         <span class="keywordflow">if</span> (!verifyLatestEvent(nEvt+1,EVT_ILLEGAL_MP))
00091             <span class="keywordflow">return</span>;
00092     }
00093 
00094         <span class="comment">// These profile checks shall not fail</span>
00095         <span class="keywordflow">if</span> (pPL-&gt;<a class="code" href="classMonitoringProfile.html#a1">deviatesFromProfile</a>((<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)-1)) {
00096                 setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"doProfileCheck(TD_Integer): unexpected failure"</span>);
00097                 <span class="keywordflow">return</span>;
00098         }
00099 
00100         <span class="keywordflow">if</span> (pPL-&gt;<a class="code" href="classMonitoringProfile.html#a1">deviatesFromProfile</a>((<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)-1.0)) {
00101                 setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"doProfileCheck(TD_Float): unexpected failure"</span>);
00102                 <span class="keywordflow">return</span>;
00103         }
00104 
00105         <span class="comment">// These profile checks shall fail</span>
00106         <span class="keywordflow">if</span> (!pPL-&gt;<a class="code" href="classMonitoringProfile.html#a1">deviatesFromProfile</a>((<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)1)) {
00107                 setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"doProfileCheck(TD_Integer): unexpected success"</span>);
00108                 <span class="keywordflow">return</span>;
00109         }
00110 
00111         <span class="keywordflow">if</span> (!pPL-&gt;<a class="code" href="classMonitoringProfile.html#a1">deviatesFromProfile</a>((<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)1.0)) {
00112                 setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"doProfileCheck(TD_Float): unexpected success"</span>);
00113                 <span class="keywordflow">return</span>;
00114         }
00115 
00116         <span class="keywordflow">if</span> (!pPL-&gt;<a class="code" href="classMonitoringProfile.html#a1">deviatesFromProfile</a>((<a class="code" href="BasicTypes_8h.html#a18">TD_Integer</a>)(listSize+rangeWidth-2))) {
00117                 setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"doProfileCheck(TD_Integer): unexpected success"</span>);
00118                 <span class="keywordflow">return</span>;
00119         }
00120 
00121         <span class="keywordflow">if</span> (!pPL-&gt;<a class="code" href="classMonitoringProfile.html#a1">deviatesFromProfile</a>((<a class="code" href="BasicTypes_8h.html#a17">TD_Float</a>)(listSize+rangeWidth-2.0))) {
00122                 setTestResult(<a class="code" href="TestConstants_8h.html#a1">TEST_FAILURE</a>,<span class="stringliteral">"doProfileCheck(TD_Float): unexpected success"</span>);
00123                 <span class="keywordflow">return</span>;
00124         }
00125 
00126         setTestResult(<a class="code" href="TestConstants_8h.html#a0">TEST_SUCCESS</a>,<span class="stringliteral">"Test Successful"</span>);
00127         <span class="keywordflow">return</span>;
00128 }
</div></pre><center>
<b>Copyright 2003 <a href="http://www.pnp-software.com/" target="_parent">P&P Software GmbH</a> - All Rights Reserved</b>
</center>
